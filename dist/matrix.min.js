function Matrix(t){var n=this;n._t=n.transform,n.a=n.d=1,n.b=n.c=n.e=n.f=0,n.context=t,t&&t.setTransform(1,0,0,1,0,0)}Matrix.prototype={concat:function(t){return this.clone()._t(t.a,t.b,t.c,t.d,t.e,t.f)},flipX:function(){return this._t(-1,0,0,1,0,0)},flipY:function(){return this._t(1,0,0,-1,0,0)},reflectVector:function(t,n){var r=this.applyToPoint(0,1),e=2*(r.x*t+r.y*n);return t-=e*r.x,n-=e*r.y,{x:t,y:n}},reset:function(){return this.setTransform(1,0,0,1,0,0)},rotate:function(t){var n=Math.cos(t),r=Math.sin(t);return this._t(n,r,-r,n,0,0)},rotateFromVector:function(t,n){return this.rotate(Math.atan2(n,t))},rotateDeg:function(t){return this.rotate(t*Math.PI/180)},scaleU:function(t){return this._t(t,0,0,t,0,0)},scale:function(t,n){return this._t(t,0,0,n,0,0)},scaleX:function(t){return this._t(t,0,0,1,0,0)},scaleY:function(t){return this._t(1,0,0,t,0,0)},shear:function(t,n){return this._t(1,n,t,1,0,0)},shearX:function(t){return this._t(1,0,t,1,0,0)},shearY:function(t){return this._t(1,t,0,1,0,0)},skew:function(t,n){return this.shear(Math.tan(t),Math.tan(n))},skewX:function(t){return this.shearX(Math.tan(t))},skewY:function(t){return this.shearY(Math.tan(t))},setTransform:function(t,n,r,e,a,i){var s=this;return s.a=t,s.b=n,s.c=r,s.d=e,s.e=a,s.f=i,s._x()},translate:function(t,n){return this._t(1,0,0,1,t,n)},translateX:function(t){return this._t(1,0,0,1,t,0)},translateY:function(t){return this._t(1,0,0,1,0,t)},transform:function(t,n,r,e,a,i){var s=this,o=s.a,c=s.b,u=s.c,f=s.d,h=s.e,l=s.f;return s.a=o*t+u*n,s.b=c*t+f*n,s.c=o*r+u*e,s.d=c*r+f*e,s.e=o*a+u*i+h,s.f=c*a+f*i+l,s._x()},divide:function(t){if(!t.isInvertible())throw"Input matrix is not invertible";var n=t.inverse();return this._t(n.a,n.b,n.c,n.d,n.e,n.f)},divideScalar:function(t){var n=this;return n.a/=t,n.b/=t,n.c/=t,n.d/=t,n.e/=t,n.f/=t,n._x()},inverse:function(){if(this.isIdentity())return new Matrix;if(this.isInvertible()){var t=this,n=t.a,r=t.b,e=t.c,a=t.d,i=t.e,s=t.f,o=new Matrix,c=n*a-r*e;return o.a=a/c,o.b=-r/c,o.c=-e/c,o.d=n/c,o.e=(e*s-a*i)/c,o.f=-(n*s-r*i)/c,o}throw"Matrix is not invertible."},interpolate:function(t,n,r){var e=this,a=r?new Matrix(r):new Matrix;return a.a=e.a+(t.a-e.a)*n,a.b=e.b+(t.b-e.b)*n,a.c=e.c+(t.c-e.c)*n,a.d=e.d+(t.d-e.d)*n,a.e=e.e+(t.e-e.e)*n,a.f=e.f+(t.f-e.f)*n,a._x()},interpolateAnim:function(t,n,r){var e=this,a=r?new Matrix(r):new Matrix,i=e.decompose(),s=t.decompose(),o=i.rotation+(s.rotation-i.rotation)*n,c=i.translate.x+(s.translate.x-i.translate.x)*n,u=i.translate.y+(s.translate.y-i.translate.y)*n,f=i.scale.x+(s.scale.x-i.scale.x)*n,h=i.scale.y+(s.scale.y-i.scale.y)*n;return a.translate(c,u),a.rotate(o),a.scale(f,h),a._x()},decompose:function(t){var n=this,r=n.a,e=n.b,a=n.c,i=n.d,s=Math.acos,o=Math.atan,c=Math.sqrt,u=Math.PI,f={x:n.e,y:n.f},h=0,l={x:1,y:1},x={x:0,y:0},y=r*i-e*a;if(t)r?(x={x:o(a/r),y:o(e/r)},l={x:r,y:y/r}):e?(h=.5*u,l={x:e,y:y/e},x.x=o(i/e)):(l={x:a,y:i},x.x=.25*u);else if(r||e){var d=c(r*r+e*e);h=e>0?s(r/d):-s(r/d),l={x:d,y:y/d},x.x=o((r*a+e*i)/(d*d))}else if(a||i){var _=c(a*a+i*i);h=.5*u-(i>0?s(-a/_):-s(a/_)),l={x:y/_,y:_},x.y=o((r*a+e*i)/(_*_))}else l={x:0,y:0};return{scale:l,translate:f,rotation:h,skew:x}},determinant:function(){return this.a*this.d-this.b*this.c},applyToPoint:function(t,n){var r=this;return{x:t*r.a+n*r.c+r.e,y:t*r.b+n*r.d+r.f}},applyToArray:function(t){var n,r,e=0,a=[];if("number"==typeof t[0])for(r=t.length;r>e;)n=this.applyToPoint(t[e++],t[e++]),a.push(n.x,n.y);else for(;n=t[e];e++)a.push(this.applyToPoint(n.x,n.y));return a},applyToTypedArray:function(t,n){for(var r,e=0,a=t.length,i=n?new Float64Array(a):new Float32Array(a);a>e;)r=this.applyToPoint(t[e],t[e+1]),i[e++]=r.x,i[e++]=r.y;return i},applyToContext:function(t){var n=this;return t.setTransform(n.a,n.b,n.c,n.d,n.e,n.f),n},isIdentity:function(){var t=this;return t._q(t.a,1)&&t._q(t.b,0)&&t._q(t.c,0)&&t._q(t.d,1)&&t._q(t.e,0)&&t._q(t.f,0)},isInvertible:function(){return!this._q(this.determinant(),0)},isValid:function(){return!this._q(this.a*this.d,0)},clone:function(t){var n=this,r=new Matrix;return r.a=n.a,r.b=n.b,r.c=n.c,r.d=n.d,r.e=n.e,r.f=n.f,t||(r.context=n.context),r},isEqual:function(t){var n=this,r=n._q;return r(n.a,t.a)&&r(n.b,t.b)&&r(n.c,t.c)&&r(n.d,t.d)&&r(n.e,t.e)&&r(n.f,t.f)},toArray:function(){var t=this;return[t.a,t.b,t.c,t.d,t.e,t.f]},toCSS:function(){return"matrix("+this.toArray()+")"},toJSON:function(){return JSON.stringify(this.toArray())},toString:function(){return""+this.toArray()},_q:function(t,n){return Math.abs(t-n)<1e-14},_x:function(){var t=this;return t.context&&t.context.setTransform(t.a,t.b,t.c,t.d,t.e,t.f),t}};
